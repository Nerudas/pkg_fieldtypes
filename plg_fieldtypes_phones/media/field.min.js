(function(a){a(document).ready(function(){a("[data-input-phones]").each(function(){var i=a(input),c=i.attr("id"),h=i.find('.item[data-key="phone_X"]'),k=i.find("#"+c+"_result"),d=i.closest("form");if(!i.selector){i.selector="#"+i.attr("id")}var f=Joomla.getOptions(c,""),g=f.limit;j();a("body").on("click",i.selector+" .actions .add",function(){j()});a("body").on("click",i.selector+" .actions .remove",function(){a(input).closest(".item").remove();if(k.find(".item").length==0){j()}e();b()});a(k.selector).sortable({handle:".actions .move",start:function(l,m){k.addClass("sortable")},stop:function(l,m){e();k.removeClass("sortable")}});a("body").on("keyup","#"+c+' [name*="number"]',function(){var n=a(input).val().replace(/[^.\d]+/g,"").replace(/^([^.]*\.)|\./g,"$1");a(input).val(n);var m=a(input).closest(".item").find('[name*="code"]').val();var l=a(input).closest(".item").find('[name*="display"]');a(l).val(m+n)});a("body").on("change","#"+c+' [name*="number"]',function(){var n=a(input).val().replace(/[^.\d]+/g,"").replace(/^([^.]*\.)|\./g,"$1");a(input).val(n);var m=a(input).closest(".item").find('[name*="code"]').val();var l=a(input).closest(".item").find('[name*="display"]');a(l).val(m+n)});a(d).on("submit",function(){k.find('[name*="number"]').each(function(n,m){if(a(m).val()==""){a(m).closest(".item").remove();e()}var p=a(m).val().replace(/[^.\d]+/g,"").replace(/^([^.]*\.)|\./g,"$1");a(m).val(p);var o=a(m).closest(".item").find('[name*="code"]').val();var l=a(m).closest(".item").find('[name*="display"]');a(l).val(o+p)})});function j(){var l=b();if(l){var m=h.clone();a(m).find("input").each(function(o,n){a(n).attr("id",a(n).data("id"));a(n).attr("name",a(n).data("name"));a(n).removeAttr("data-id");a(n).removeAttr("data-name")});a(m).appendTo(k);e();b()}}function b(){var l=false;if(g==0){l=true}var m=k.find(".item").length;if(!l&&m<g){l=true}if(!l){a(i.selector+" .actions .add").attr("disabled","true")}else{a(i.selector+" .actions .add").removeAttr("disabled")}return l}function e(){k.find(".item").each(function(l,n){var o=a(n).attr("data-key");var m="phone";var p=new RegExp(o,"g");a(n).find('[id*="'+m+'_"]').each(function(q,r){var s=a(r).attr("id").replace(p,m+"_"+(l+1));a(r).attr("id",s)});a(n).find('[name*="'+m+'_"]').each(function(q,r){var s=a(r).attr("name").replace(p,m+"_"+(l+1));a(r).attr("name",s)});a(n).attr("data-key",m+"_"+(l+1))})}})})})(jQuery);